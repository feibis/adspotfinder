"use client"

import { formatNumber } from "@primoui/utils"
import { AtSignIcon, RssIcon } from "lucide-react"
import { useTranslations } from "next-intl"
import type { ComponentProps } from "react"
import { H5, H6 } from "~/components/common/heading"
import { BrandGitHubIcon } from "~/components/common/icons/brand-github"
import { Note } from "~/components/common/note"
import { Stack } from "~/components/common/stack"
import { Tooltip } from "~/components/common/tooltip"
import { CTAForm } from "~/components/web/cta-form"
import { ExternalLink } from "~/components/web/external-link"
import { ThemeSwitcher } from "~/components/web/theme-switcher"
import { NavLink, navLinkVariants } from "~/components/web/ui/nav-link"
import { adsConfig } from "~/config/ads"
import { linksConfig } from "~/config/links"
import { siteConfig } from "~/config/site"
import { cx } from "~/lib/utils"

type FooterProps = ComponentProps<"div"> & {
  hideCTA?: boolean
}

export const Footer = ({ children, className, hideCTA, ...props }: FooterProps) => {
  const t = useTranslations()

  return (
    <footer className="flex flex-col gap-y-8 mt-auto pt-fluid-md border-t border-foreground/10">
      <div
        className={cx("grid grid-cols-2 gap-y-8 gap-x-4 md:gap-x-6 md:grid-cols-12", className)}
        {...props}
      >
        <Stack
          direction="column"
          className="flex flex-col items-start gap-4 col-span-full md:col-span-5"
        >
          <Stack size="lg" direction="column" className="min-w-0 max-w-64">
            <H5 as="strong" className="px-0.5">
              {t("components.footer.cta_title")}
            </H5>

            <Note className="-mt-2 px-0.5 first:mt-0">
              {t("components.footer.cta_description", { count: formatNumber(5000, "standard") })}
            </Note>

            <CTAForm />
          </Stack>

          <Stack className="text-lg opacity-75">
            <Tooltip tooltip={t("navigation.toggle_theme")}>
              <ThemeSwitcher />
            </Tooltip>

            <Tooltip tooltip={t("navigation.rss_feed")}>
              <ExternalLink href={linksConfig.feed} className={navLinkVariants()}>
                <RssIcon />
              </ExternalLink>
            </Tooltip>

            <Tooltip tooltip={t("navigation.contact_us")}>
              <ExternalLink href={`mailto:${siteConfig.email}`} className={navLinkVariants()}>
                <AtSignIcon />
              </ExternalLink>
            </Tooltip>

            <Tooltip tooltip={t("navigation.source_code")}>
              <ExternalLink href={linksConfig.github} className={navLinkVariants()}>
                <BrandGitHubIcon />
              </ExternalLink>
            </Tooltip>
          </Stack>
        </Stack>

        <Stack direction="column" className="text-sm md:col-span-2 md:col-start-7">
          <H6 as="strong">For Clients:</H6>

          <NavLink href="/">{t("navigation.tools")}</NavLink>
          <NavLink href="/blog">{t("navigation.blog")}</NavLink>
        </Stack>

        <Stack direction="column" className="text-sm md:col-span-2">
          <H6 as="strong">Navigation:</H6>

          <NavLink href="/shops">{t("navigation.shops")}</NavLink>
          <NavLink href="/categories">{t("navigation.categories")}</NavLink>
          <NavLink href="/tags">{t("navigation.tags")}</NavLink>
        </Stack>

        <Stack direction="column" className="text-sm md:col-span-2">
          <H6 as="strong">For Providers:</H6>

          <NavLink href="/submit">{t("navigation.submit")}</NavLink>
          {adsConfig.enabled && <NavLink href="/advertise">{t("navigation.advertise")}</NavLink>}
        </Stack>

        <Stack direction="column" className="text-sm md:col-span-1">
          <H6 as="strong">Company:</H6>

          <NavLink href="/about">{t("navigation.about")}</NavLink>
          <ExternalLink href={`mailto:${siteConfig.email}`} className={navLinkVariants()}>
            {t("navigation.contact_us")}
          </ExternalLink>
        </Stack>
      </div>

      {children}
    </footer>
  )
}
